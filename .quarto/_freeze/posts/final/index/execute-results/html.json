{
  "hash": "8ddc8ebddcd24213b181433a737e2e55",
  "result": {
    "markdown": "---\ntitle: \"Comprehensive demonstartion of R prgramming language through a randomly generated dataset.\"\nauthor: \"Sreekanya Peddireddi\"\ndate: \"2023-12-13\"\ncategories: [news, code, analysis,plotly,plot]\nimage: \"image.jpg\"\n---\n\n\n## INTRODUCTION\n\nWe are going to explore R programming language as skill attained over time as i have learnt and understood it. In this project an going to generate a random data set of 100 multiple and different labeling and in turn conduct a simple data arrangement sorting cleaning EDA (exploratory data analysis) and a linear regression model with proper visualization and accuracy measures telemeters.\n\n# RANDOM DATASET\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'kableExtra'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n:::\n\n```{.r .cell-code}\nset.seed(123)\n\nnum_samples <- 100\n\ndata <- tibble(\n  ID = 1:num_samples,\n  Age = sample(18:60, num_samples, replace = TRUE),\n  Gender = sample(c(\"Male\", \"Female\"), num_samples, replace = TRUE),\n  Income = rnorm(num_samples, mean = 50000, sd = 15000),\n  Education_Level = sample(c(\"High School\", \"Bachelor's\", \"Master's\", \"PhD\"), num_samples, replace = TRUE),\n  Region = sample(c(\"North\", \"South\", \"East\", \"West\"), num_samples, replace = TRUE),\n  Product_A = rpois(num_samples, lambda = 10),\n  Product_B = rpois(num_samples, lambda = 15)\n)\n\n# Displaying the dataset using kableExtra\ndata %>%\n  head() %>%\n  kable() %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> ID </th>\n   <th style=\"text-align:right;\"> Age </th>\n   <th style=\"text-align:left;\"> Gender </th>\n   <th style=\"text-align:right;\"> Income </th>\n   <th style=\"text-align:left;\"> Education_Level </th>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Product_A </th>\n   <th style=\"text-align:right;\"> Product_B </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 48 </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 34638.07 </td>\n   <td style=\"text-align:left;\"> Bachelor's </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 51764.70 </td>\n   <td style=\"text-align:left;\"> Master's </td>\n   <td style=\"text-align:left;\"> North </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 35787.88 </td>\n   <td style=\"text-align:left;\"> Master's </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 42641.64 </td>\n   <td style=\"text-align:left;\"> High School </td>\n   <td style=\"text-align:left;\"> East </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 46158.62 </td>\n   <td style=\"text-align:left;\"> Bachelor's </td>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 77657.93 </td>\n   <td style=\"text-align:left;\"> PhD </td>\n   <td style=\"text-align:left;\"> West </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## DATA EXPLORATION\nDue to the size we will just conduct a few exploratory analysis without going into detail but we will demonstrate the relationship between the product bought and the type of people whom bought it and their education level. \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\n\n# Summary statistics by Education Level for Product A and Product B\nsummary_stats <- data %>%\n  group_by(Education_Level) %>%\n  summarise(\n    Mean_Product_A = mean(Product_A),\n    Mean_Product_B = mean(Product_B),\n    Median_Product_A = median(Product_A),\n    Median_Product_B = median(Product_B),\n    Total_Product_A = sum(Product_A),\n    Total_Product_B = sum(Product_B)\n  )\n\nprint(summary_stats)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 7\n  Education_Level Mean_Product_A Mean_Product_B Median_Product_A\n  <chr>                    <dbl>          <dbl>            <dbl>\n1 Bachelor's               10.3            14.4             11  \n2 High School               9.5            14.5              9.5\n3 Master's                 11.1            16.4             11  \n4 PhD                       9.31           15.5             10  \n# ℹ 3 more variables: Median_Product_B <dbl>, Total_Product_A <int>,\n#   Total_Product_B <int>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Visualizing Product A and Product B purchases by Education Level\npurchase_plot <- data %>%\n  gather(Product, Purchases, Product_A, Product_B) %>%\n  ggplot(aes(x = Education_Level, y = Purchases, fill = Product)) +\n  geom_boxplot() +\n  labs(\n    title = \"Product A and Product B Purchases by Education Level\",\n    x = \"Education Level\",\n    y = \"Number of Purchases\"\n  ) +\n  scale_fill_manual(values = c(\"Product_A\" = \"blue\", \"Product_B\" = \"green\")) +\n  theme_minimal()\n\nprint(purchase_plot)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## LOGISTICS LINEAR REGRESSION MODEL\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n```{.r .cell-code}\nset.seed(123)\n\n# Assuming 'Income' is the target variable, creating predictors (X) and target variable (y)\nX <- data %>% select(-ID, -Income)\ny <- data$Income\n\n# Splitting the data into training and testing sets (80% training, 20% testing)\ntrain_index <- createDataPartition(y, p = 0.8, list = FALSE)\ntrain_data <- data[train_index, ]\ntest_data <- data[-train_index, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the necessary library\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\n# Fit a linear regression model\nlm_model <- lm(Income ~ ., data = train_data)\n\n# Summary of the model\nsummary(lm_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Income ~ ., data = train_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-26873 -10378     25   8158  38371 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                66128.71   11763.16   5.622 3.84e-07 ***\nID                            -8.06      63.92  -0.126   0.9000    \nAge                          -83.52     159.98  -0.522   0.6033    \nGenderMale                  8207.19    3662.38   2.241   0.0283 *  \nEducation_LevelHigh School -5147.42    5075.71  -1.014   0.3141    \nEducation_LevelMaster's     5432.97    5946.04   0.914   0.3641    \nEducation_LevelPhD         -1400.37    4793.47  -0.292   0.7711    \nRegionNorth                -8155.90    5624.61  -1.450   0.1516    \nRegionSouth                -4549.72    4943.93  -0.920   0.3607    \nRegionWest                 -1352.63    4684.63  -0.289   0.7737    \nProduct_A                   -295.84     657.16  -0.450   0.6540    \nProduct_B                   -626.64     510.97  -1.226   0.2243    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15060 on 68 degrees of freedom\nMultiple R-squared:  0.1438,\tAdjusted R-squared:  0.005288 \nF-statistic: 1.038 on 11 and 68 DF,  p-value: 0.4237\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Making predictions on the test set\npredictions <- predict(lm_model, newdata = test_data)\n\n# Calculate model performance metrics (e.g., RMSE, R-squared)\nrmse <- sqrt(mean((test_data$Income - predictions)^2))\nrsquared <- summary(lm_model)$r.squared\n\ncat(\"Root Mean Squared Error (RMSE):\", rmse, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRoot Mean Squared Error (RMSE): 18523.96 \n```\n:::\n\n```{.r .cell-code}\ncat(\"R-squared:\", rsquared, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR-squared: 0.1437925 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotting actual vs predicted values\nlibrary(ggplot2)\n\n# Creating a data frame with actual and predicted values\nresults <- data.frame(Actual = test_data$Income, Predicted = predictions)\n\n# Scatterplot\nggplot(results, aes(x = Actual, y = Predicted)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"Actual vs Predicted Income\", x = \"Actual Income\", y = \"Predicted Income\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Diagnostic plots for linear regression\nplot(lm_model)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-5.png){width=672}\n:::\n:::\n\n\n\n## RESULTS AND DISCUSSIONS\nThe regression analysis aimed to examine the factors influencing the dependent variable, presumably a monetary measure. The model included various independent variables such as ID, Age, Gender, Education Level, Region, and Product type. The coefficients of the model indicate the estimated impact of each variable on the outcome.\nThe results indicate that most coefficients lack statistical significance in predicting the dependent variable, as evident from their high p-values. Notably, Gender (specifically being Male) exhibited a statistically significant positive relationship with the outcome, suggesting that males tend to have a higher value in the dependent variable compared to females. However, caution is advised in interpreting this result due to the limited significance of other variables in the model.\nMoreover, variables such as Education Level, Region, and Product type did not show substantial influence on the dependent variable, as their coefficients were not statistically significant. The overall model fit is weak, with an adjusted R-squared of 0.005288, indicating that the independent variables collectively explain only a small proportion of the variability in the dependent variable.\n\n## CONCLUSION\nIn conclusion, based on this analysis, the model does not adequately explain the variations in the dependent variable using the selected independent variables. Further investigation or refinement of the model by considering additional relevant factors or improving the dataset might be necessary to achieve a more accurate understanding of the factors affecting the outcome variable.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}